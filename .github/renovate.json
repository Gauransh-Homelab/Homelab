{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":semanticCommitTypeAll(feat)"
  ],
  "automerge": true,
  "platformAutomerge": true,
  "timezone": "Asia/Singapore",
  "labels": [
    "renovate",
    "dependencies"
  ],
  "assignees": [
    "GauranshMathur"
  ],
  "reviewers": [
    "GauranshMathur"
  ],
  "rebaseWhen": "behind-base-branch",
  "kubernetes": {
    "managerFilePatterns": [
      "/\\.yaml$/",
      "/\\.yml$/"
    ]
  },
  "packageRules": [
    {
      "matchCategories": [
        "docker"
      ],
      "pinDigests": false
    },
    {
      "description": "LinuxServer.io images - support v-prefix, 3-part and 4-part versions",
      "matchDatasources": [
        "docker"
      ],
      "versioning": "regex:^v?(?<major>\\d+)(?:\\.(?<minor>\\d+))?(?:\\.(?<patch>\\d+))?(?:\\.(?<build>\\d+))?-ls(?<revision>\\d+)$",
      "matchPackageNames": [
        "/^(gh|ls)cr\\.io/linuxserver//"
      ]
    },
    {
      "description": "Filter out pre-release versions",
      "matchDatasources": [
        "docker"
      ],
      "allowedVersions": "!/^.*-(alpha|beta|rc|dev|canary|unstable|preview|pre|test|experimental).*$/"
    },
    {
      "description": "Review stable container updates manually",
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "minor",
        "patch",
        "digest"
      ],
      "matchPackageNames": [
        "lscr.io/linuxserver/sonarr",
        "lscr.io/linuxserver/radarr",
        "lscr.io/linuxserver/bazarr",
        "lscr.io/linuxserver/prowlarr",
        "lscr.io/linuxserver/qbittorrent",
        "lscr.io/linuxserver/nzbget",
        "linuxserver/sonarr",
        "linuxserver/radarr",
        "linuxserver/bazarr",
        "linuxserver/prowlarr",
        "linuxserver/qbittorrent",
        "linuxserver/nzbget",
        "jellyfin/jellyfin",
        "fallenbagel/jellyseerr",
        "golift/notifiarr",
        "gcr.io/distroless/static",
        "qmcgaw/gluetun"
      ]
    },
    {
      "description": "Review k8s infrastructure updates manually",
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "matchPackageNames": [
        "registry.k8s.io/descheduler/descheduler",
        "quay.io/jetstack/cert-manager-controller",
        "quay.io/jetstack/cert-manager-webhook",
        "quay.io/jetstack/cert-manager-cainjector",
        "traefik",
        "ghcr.io/onedr0p/kubernetes-kubectl"
      ]
    },
    {
      "description": "Group ArgoCD updates",
      "matchDatasources": [
        "docker",
        "helm"
      ],
      "groupName": "ArgoCD",
      "automerge": false,
      "matchPackageNames": [
        "/argo-cd/",
        "/argocd/"
      ]
    },
    {
      "description": "Allow major updates but don't auto-merge",
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "major"
      ],
      "enabled": true,
      "automerge": false
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Process all container images in Kubernetes files",
      "managerFilePatterns": [
        "/\\.yaml$/",
        "/\\.yml$/"
      ],
      "matchStrings": [
        "image:\\s+(?<depName>[^\\s:]+):(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker"
    }
  ],
  "ignorePresets": [
    ":prHourlyLimit2"
  ],
  "commitMessagePrefix": "feat({{packageFileDir}}):",
  "commitMessageTopic": "update {{depName}} to {{newVersion}}",
  "commitMessageExtra": "from {{currentVersion}}",
  "prCreation": "immediate",
  "prHourlyLimit": 10,
  "prConcurrentLimit": 20
}
